@if ((hiddenScroll$ | async) && (groupSelected$ | async)) {
<tui-icon  icon="@tui.arrow-right" class="hidden-arrow"></tui-icon>
}

<tui-scrollbar #scrollbar class="group-tree" [hidden]="(hiddenScroll$ | async) === true"
    [ngClass]="{'group-tree-hide': groupSelected$ | async}" (mouseenter)="onMouseEnter()" (mouseleave)="onMouseLeave()">

    @if (loadingNodes$ | async) {
    <tui-loader class="tui-space_top-3" [inheritColor]="true"></tui-loader>
    }
    @else {
    <tui-elastic-container>
        @for (node of treeNodes$ | async; track node.Id) {
        @defer{
        <ng-container [ngTemplateOutlet]="nodeTemplate" [ngTemplateOutletContext]="{$implicit: node}"></ng-container>
        } @placeholder {
        <tui-loader class="tui-space_top-3" [inheritColor]="true"></tui-loader>
        }
        }
    </tui-elastic-container>
    }
</tui-scrollbar>

<ng-template #nodeTemplate let-node>
    <div class="tree-main">
        <div class="tree" (click)="node.children? node.expanded = !node.expanded : onSelectGroup(node)">
            <div class="tree-content">
                <div class="tree-left-content">
                    <tui-icon  class="tui-space_right-2" [ngClass]="{'active-tree': node.selected | async}"
                        [icon]="node.children?'@tui.folder': '@tui.file'"></tui-icon>
                    <div class="tree-name tui-space_right-2">
                        <!-- TODO: (Taiga UI migration) (focusedChange) output has been removed. Use native (focusin) / (focusout) instead -->
                         <tui-input-inline #input [(ngModel)]="node.Name" [class.input_empty]="!$any(input).value"
                            (click)="$event.stopPropagation()" (focusin)="onFocusName($any($event), input, node)">
                            {{node.OriginalName}}
                        </tui-input-inline>
                    </div>
                </div>
                <div class="tree-right-content">
                    @if((node.TranslatedFiles / node.Files) < 1){ <span class="tree-status">
                        [{{ node.TranslatedFiles }} /{{node.Files }}]
                        </span>
                        } @else {
                        <tui-icon  icon="@tui.circle-check"></tui-icon>
                        }
                </div>
            </div>
        </div>
        @if (node.saving | async) {
        <progress class="tree-progress-bar" max="100" tuiProgressBar></progress>
        }
    </div>
    <tui-expand class="tui-space_left-6" [expanded]="node.expanded ?? false">
        @for (childNode of node.children; track childNode.Id) {
        @defer {
        <ng-container [ngTemplateOutlet]="nodeTemplate" [ngTemplateOutletContext]="{$implicit: childNode}">
        </ng-container>
        }
        }
    </tui-expand>
</ng-template>