@if ((hiddenScroll$ | async) && (groupSelected$ | async)) {
<tui-icon icon="@tui.mouse-pointer-2" class="hidden-arrow" />
}

<tui-scrollbar #scrollbar class="group-tree" [hidden]="(hiddenScroll$ | async) === true"
    [ngClass]="{'group-tree-hide': groupSelected$ | async}" (mouseenter)="onMouseEnter()" (mouseleave)="onMouseLeave()">

    @if (loadingNodes$ | async) {
    <tui-loader class="tui-space_top-3" [inheritColor]="true" />
    }
    @else {
    <tui-elastic-container>
        @for (node of treeNodes$ | async; track node.Id) {
        @defer{
        <ng-container [ngTemplateOutlet]="nodeTemplate" [ngTemplateOutletContext]="{$implicit: node}" />
        } @placeholder {
        <tui-loader class="tui-space_top-3" [inheritColor]="true" />
        }
        }
    </tui-elastic-container>
    }
</tui-scrollbar>

<ng-template #nodeTemplate let-node>
    <div class="tree-main">
        <div class="tree" (click)="node.children? node.expanded = !node.expanded : onSelectGroup(node)">
            <div class="tree-content">
                <div class="tree-left-content">
                    <tui-icon class="tui-space_right-2" [ngClass]="{'active-tree': node.selected | async}"
                        [icon]="node.children?'@tui.folder': '@tui.file'" />
                    <div class="tree-name tui-space_right-2">
                        <tui-input-inline #input [class.input_empty]="!$any(input).value"
                            (click)="$event.stopPropagation()" (focusin)="onFocusName($any($event), input, node)">
                            {{node.OriginalName}}
                            <input [(ngModel)]="node.Name" aria-label="Input" />
                        </tui-input-inline>
                    </div>
                </div>
                <div class="tree-right-content">
                    @if((node.TranslatedFiles / node.Files) < 1){ <span class="tree-status">
                        [{{ node.TranslatedFiles }} /{{node.Files }}]
                        </span>
                        } @else {
                        <tui-icon icon="@tui.circle-check" />
                        }
                </div>
            </div>
        </div>
        @if (node.saving | async) {
        <progress new tuiProgressBar [max]="100" class="tree-progress-bar"></progress>
        }
    </div>
    <tui-expand class="tui-space_left-6" [expanded]="node.expanded ?? false">
        @for (childNode of node.children; track childNode.Id) {
        @defer {
        <ng-container [ngTemplateOutlet]="nodeTemplate" [ngTemplateOutletContext]="{$implicit: childNode}" />
        }
        }
    </tui-expand>
</ng-template>