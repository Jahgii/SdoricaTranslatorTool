@if (dAS.mainGroup) {
<ng-container *ngIf="(dAS.dialogAssetsChange$ | async) && (dAS.dialogAssets$ | async) as data; else loading;">
    <ng-container [ngTemplateOutlet]="simpleUI" [ngTemplateOutletContext]="{$implicit: data}"></ng-container>
</ng-container>
}
@else {
<div class="group-no-selected">
    <tui-block-status [card]="true">
        <img alt="not found" src="./assets/images/localization-not.svg" tuiSlot="top" class="image" />
        {{'select-group-tree' | translate}}
    </tui-block-status>
</div>
}

<ng-template #simpleUI let-data>
    <div class="top-main-options tui-space_bottom-2">
        <div class="option-child">
            <span class="tui-text_body-s tui-space_right-4 text-bold">{{'file-number' | translate}}:</span>
            <tui-tabs-with-more [itemsLimit]="5" [(activeItemIndex)]="dAS.activeItemIndex" class="tabs"
                [moreContent]="moreContentIcon">
                <ng-container *ngFor="let item of data">
                    <button *tuiItem tuiTab>
                        {{item.Number}}
                        @if (item.Translated) {
                        <tui-icon class="tui-space_left-3" icon="@tui.circle-check"></tui-icon>
                        }
                    </button>
                </ng-container>
            </tui-tabs-with-more>
        </div>
        <div class="option-child">
            @if ((breakpointService.mode$ | async) === 'desktopLarge' || (breakpointService.mode$ | async) ===
            'desktopSmall') {
            <span *ngIf="dAS.pendingChanges$ | async" class="tui-space_right-5">
                {{'saving-changes' | translate}}
            </span>
            <span class="tui-space_right-1">
                {{'translated' | translate}}:
            </span>
            <input tuiSwitch type="checkbox" class="tui-space_right-4" [showIcons]="true"
                [(ngModel)]="data[dAS.activeItemIndex].Translated" (ngModelChange)="onTranslatedChange(data, $event)"
                appareance="outline" />
            <span class="tui-space_right-1">{{'propagation' | translate}}:</span>
            <input tuiSwitch type="checkbox" [showIcons]="true" [(ngModel)]="dAS.propagateTranslation"
                [tuiHint]="propagationTooltip" tuiHintDirection="right" />
            <button tuiIconButton type="button" appearance="icon" shape="square"
                tuiHint="{{'download-dialog-file' | translate}}" [tuiHintAppearance]="'onDark'"
                (click)="onDownload(data[dAS.activeItemIndex])" iconStart="@tui.download">
            </button>
            <button tuiIconButton type="button" appearance="icon" shape="square"
                tuiHint="{{'copy-dialog-file' | translate}}" [tuiHintAppearance]="'onDark'"
                (click)="onCopyToClipboard(data[dAS.activeItemIndex])" iconStart="@tui.copy">
            </button>
            <button tuiIconButton type="button" appearance="icon" shape="square"
                tuiHint="{{'paste-dialog-file' | translate}}" [tuiHintAppearance]="'onDark'"
                (click)="onPasteClipboard(data[dAS.activeItemIndex])" iconStart="@tui.clipboard">
            </button>
            <tui-loader [showLoader]="(dAS.libreTranslate.translating$ | async) ?? false" [inheritColor]="true"
                [overlay]="true">
                <button tuiIconButton type="button" appearance="icon" shape="square" iconStart="@tui.box"
                    [tuiHint]="((dAS.libreTranslate.serverReady$ | async)) ?
                        ('libretranslate-button-ready' | translate):
                        ('libretranslate-button-disabled' | translate)"
                    [tuiHintAppearance]="((dAS.libreTranslate.serverReady$ | async)) ? 'onDark' : 'error'"
                    (click)="onMachineTranslate(data)" [disabled]="!(dAS.libreTranslate.serverReady$ | async)">
                </button>
            </tui-loader>
            }
            @else if ((breakpointService.mode$ | async) === 'mobile') {
            <span *ngIf="dAS.pendingChanges$ | async" class="pending-changes-text">
                {{'saving-changes' | translate}}
            </span>
            <button tuiIconButton type="button" appearance="icon" shape="square" [tuiDropdown]="dropdownContent"
                [tuiDropdownManual]="openOption" (click)="openOption = !openOption"
                (tuiActiveZoneChange)="onActiveZone($event)" iconStart="@tui.ellipsis-vertical" aria-label="options">
            </button>
            <ng-template #dropdownContent>
                <div class="mobile-dropdown-container">
                    <div class="dropdown-container-option">
                        <span class="tui-space_right-1">{{'translated' | translate}}:</span>
                        <input tuiSwitch type="checkbox" [showIcons]="true"
                            [(ngModel)]="data[dAS.activeItemIndex].Translated"
                            (ngModelChange)="onTranslatedChange(data, $event)" />
                    </div>
                    <div class="dropdown-container-option">
                        <span class="tui-space_right-1">{{'propagation' | translate}}:</span>
                        <input tuiSwitch type="checkbox" [showIcons]="true" [(ngModel)]="dAS.propagateTranslation"
                            [tuiHint]="propagationTooltip" tuiHintDirection="right" />
                    </div>
                    <tui-loader [showLoader]="(dAS.libreTranslate.translating$ | async) ?? false" [inheritColor]="true"
                        [overlay]="true">
                        <button tuiIconButton type="button" appearance="icon" shape="square" iconStart="@tui.box"
                            [tuiHint]="((dAS.libreTranslate.serverReady$ | async)) ?
                                        ('libretranslate-button-ready' | translate):
                                        ('libretranslate-button-disabled' | translate)"
                            [tuiHintAppearance]="((dAS.libreTranslate.serverReady$ | async)) ? 'onDark' : 'error'"
                            (click)="onMachineTranslate(data)" [disabled]="!(dAS.libreTranslate.serverReady$ | async)">
                        </button>
                    </tui-loader>
                </div>
            </ng-template>
            }
        </div>
    </div>
    <ng-container *ngIf="data[dAS.activeItemIndex] as dialogAsset">
        <cdk-virtual-scroll-viewport #viewport tuiScrollable class="viewport tui-zero-scrollbar" [maxBufferPx]="500"
            [minBufferPx]="400" [itemSize]="(breakpointService.mode$ | async) === 'desktopLarge' ? 185 : 148">
            <div *cdkVirtualFor="let item of dialogAsset.Model['$content']; trackBy: trackByItemId">
                <app-dialog-asset-single [data]="data" [dialogAsset]="dialogAsset" [item]="item" />
            </div>
        </cdk-virtual-scroll-viewport>
    </ng-container>
</ng-template>

<ng-template #moreContentIcon>
    <tui-icon icon="@tui.ellipsis"></tui-icon>
</ng-template>

<ng-template #loading>
    <div class="loading-container">
        <tui-loader [showLoader]="true" [overlay]="true" [size]="'xxl'">
            <tui-block-status>
                <h4>{{'loading-3-dots' | translate}}</h4>
            </tui-block-status>
        </tui-loader>
    </div>
</ng-template>

<ng-template #propagationTooltip>
    {{'propagation' | translate}}: {{'propagation-dialog-description-0' | translate}}
    <span class="tooltip-important-text">{{'propagation-dialog-description-1' | translate}}</span>
    {{'propagation-dialog-description-2' | translate}}
    <strong>{{'propagation-dialog-description-3' | translate}}</strong>
    {{'propagation-dialog-description-4' |translate}}
</ng-template>