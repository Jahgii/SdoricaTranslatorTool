<ng-container *ngIf="(languageOrigin.language$ | async)">
    <div class="localization-actions">
        <div class="localization-action-content">
            <app-localization-key (created)="localization.refreshAll()"></app-localization-key>
            <app-gamedata-values></app-gamedata-values>
            <app-common-words></app-common-words>
        </div>
    </div>
    <div class="localization-container" *ngIf="localization.categories$ | async as categories; else loadingCategories">
        <div class="localization-data-actions tui-space_bottom-3">
            <tui-combo-box class="category-input" [(ngModel)]="localization.selectedCategory" [tuiTextfieldSize]="'m'"
                [valueContent]="categoryInputContent" [stringify]="stringify"
                (ngModelChange)="localization.onSelectCategory(localization.selectedCategory)">
                {{'categories' | translate}}
                <input placeholder="{{'type-name' | translate}}" tuiTextfield />
                <tui-data-list-wrapper *tuiDataList [itemContent]="categoryInputContent"
                    [items]="categories | tuiFilterByInput"></tui-data-list-wrapper>
            </tui-combo-box>
            <ng-template #categoryInputContent let-data>
                <div class="template">
                    {{data.Name}} [{{data.KeysTranslated[localization.language]}}/{{data.Keys[localization.language]}}]
                </div>
            </ng-template>
            <ng-container *ngIf="localization.keys$">
                <ng-container *ngIf="localization.searchCategory$ | async; else normalH;">
                    <tui-hosted-dropdown bottomRight [content]="content" tuiMode="onLight">
                        <button tuiButton appearance="flat" icon="tuiIconFilter" size="s"
                            title="{{'filters' | translate}}">
                            {{'results' | translate}}:
                            {{localization.searchTotalTranslated}}/{{localization.keys?.length ??0}}
                        </button>
                    </tui-hosted-dropdown>
                    <ng-template #content>
                        <div style="padding: 0.5rem;">
                            <p style="max-width: 200px">
                                {{'filters-localization-description' | translate}}
                            </p>

                            <tui-input class="tui-space_bottom-3" style="width: 200px;"
                                [formControl]="localization.search" [tuiTextfieldSize]="'m'"
                                [tuiTextfieldCustomContent]="'tuiIconSearch'">
                                {{'search-by-text' | translate}}
                                <input tuiTextfield type="text" />
                            </tui-input>

                            <tui-input class="tui-space_bottom-3" style="width: 200px;"
                                [formControl]="localization.searchTranslation" [tuiTextfieldSize]="'m'"
                                [tuiTextfieldCustomContent]="'tuiIconSearch'">
                                {{'search-by-translation' | translate}}
                                <input tuiTextfield type="text" />
                            </tui-input>

                            <tui-input style="width: 200px;" [formControl]="localization.searchKey"
                                [tuiTextfieldSize]="'m'" [tuiTextfieldCustomContent]="'tuiIconSearch'">
                                {{'search-by-key' | translate}}
                                <input tuiTextfield type="text" />
                            </tui-input>
                        </div>
                    </ng-template>
                </ng-container>
                <ng-template #normalH>
                    <button tuiButton type="button" appearance="flat" size="s" tuiMode="onLight" icon="tuiIconBox"
                        [tuiHint]="((libreTranslate.serverReady$ | async)) ? 
                        ('libretranslate-button-ready' | translate):
                        ('libretranslate-button-disabled' | translate)"
                        [tuiHintAppearance]="((libreTranslate.serverReady$ | async)) ? 'onDark' : 'error'"
                        tuiHintDirection="right" (click)="localization.onMachineTranslate()"
                        [disabled]="!(libreTranslate.serverReady$ | async)"
                        [showLoader]="(libreTranslate.translating$ | async) ?? false">
                        {{'translate-all-keys' | translate}}
                    </button>
                </ng-template>
            </ng-container>
        </div>

        <app-localization-table class="localization-keys"></app-localization-table>
    </div>

    <ng-template #loadingCategories>
        <tui-block-status>
            <h4>{{'loading-categories' | translate}}</h4>
        </tui-block-status>
    </ng-template>
</ng-container>