<header class="header">
    <button tuiIconButton appearance="icon" icon="tuiIconColumns"
        (click)="onSplitModeToggle()">
    </button>
    <ng-container *ngIf="breakpointService$ | async as breakpoint">
        <ng-container *ngIf="breakpoint === 'desktopLarge' || breakpoint === 'desktopSmall'">
            <h2 style="margin-right: auto;"></h2>
        </ng-container>
        <ng-container *ngIf="breakpoint === 'mobile'">
            <h2 style="margin-right: auto;"></h2>
        </ng-container>
    </ng-container>
    <a tuiIconButton type="button" href="https://github.com/Jahgii/SdoricaTranslatorTool" target="_blank"
        appearance="icon" [icon]="'tuiIconGithub'">
    </a>
    <button tuiIconButton appearance="icon" [icon]="(theme.nightMode$ | async)? 'tuiIconMoon' : 'tuiIconSun'"
        (click)="theme.switchTheme()">
    </button>
    <button tuiIconButton appearance="icon" [icon]="'tuiIconSettings'" (click)="onToogleSettings()"
        (tuiActiveZoneChange)="onToogleSettings()">
        <tui-scrollbar *tuiSidebar="openSetting; direction: 'right'">
            <h3 style="text-align: center; padding: 1em 1em 0 1em;">{{'language-configuration' | translate}}</h3>
            <hr>
            <div style="padding: 1em;">
                <h4>{{'app-language' | translate}}</h4>
                <div orientation="vertical" tuiGroup class="w-100" [collapsed]="true">
                    <ng-container *ngFor="let lang of langs">
                        <tui-radio-block contentAlign="right" [formControl]="langControl" item="{{lang.value}}"
                            size="s">
                            {{lang.lang | translate}}
                        </tui-radio-block>
                    </ng-container>
                </div>
                <h4>{{'origin-language' | translate}}</h4>
                <p class="tui-text_body-xs" style="color: var(--important-text);">
                    {{'origin-language-description' | translate}}
                </p>
                <tui-select class="tui-space_top-2" tuiTextfieldSize="s" [formControl]="languageOrigin.language"
                    [valueContent]="originLang">
                    {{'language' | translate}}
                    <input tuiTextfield placeholder="..." />
                    <tui-data-list-wrapper *tuiDataList [items]="languageOrigin.languages" [itemContent]="originLang">
                    </tui-data-list-wrapper>
                    <ng-template #originLang let-data>
                        {{data | translate}}
                    </ng-template>
                </tui-select>
                <h3 class="tui-space_top-6" style="text-align: center;">
                    {{'libretranslate-configuration' | translate}}
                </h3>
                <hr>
                <h4>{{'libretranslate-url' | translate}}</h4>
                <tui-input class="tui-space_top-2" [(ngModel)]="libreTranslate.url" tuiTextfieldSize="s"
                    (ngModelChange)="libreTranslate.onUrlChange($event)">
                    {{'libretranslate-url' | translate}}
                    <input tuiTextfield type="url" />
                </tui-input>
                <h4>{{'libretranslate-apikey' | translate}}</h4>
                <tui-input class="tui-space_top-2" [(ngModel)]="libreTranslate.apiKey" tuiTextfieldSize="s">
                    {{'libretranslate-apikey' | translate}}
                    <input tuiTextfield />
                </tui-input>
                <h4>{{'libretranslate-status' | translate}}</h4>
                <button appearance="outline" class="w-100" tuiButton [icon]="'tuiIconActivity'" size="s"
                    (click)="libreTranslate.isAlive()"
                    [disabled]="((libreTranslate.testing$ | async) ?? true) || !libreTranslate.url">
                    {{'libretranslate-testserver' | translate}}
                </button>
                <div *ngIf="(libreTranslate.errors$ | async) as error" class="tui-space_top-2">
                    <tui-badge status="error" [value]="error" class="w-100"></tui-badge>
                </div>
                <ng-container *ngIf="(libreTranslate.serverAlive$ | async)">
                    <div class="tui-space_top-2">
                        <tui-badge status="success" value="{{'libretranslate-serveralive' | translate}}" class="w-100">
                        </tui-badge>
                    </div>

                    <h4>{{'libretranslate-origin-target' | translate}}</h4>
                    <ng-container *ngIf="libreTranslate.languages">
                        <div tuiGroup class="tui-space_top-2">
                            <div>
                                <tui-select *tuiLet="libreTranslate.languages as languages" tuiTextfieldSize="s"
                                    [(ngModel)]="libreTranslate.source" class="tui-group__inherit-item"
                                    (ngModelChange)="libreTranslate.onSourceChange($event)"
                                    [tuiTextfieldLabelOutside]="true"
                                    [valueContent]="languages ? stringify(languages) : undefined">
                                    <input tuiTextfield placeholder="{{'libretranslate-source' | translate}}" />
                                    {{'libretranslate-source' | translate}}
                                    <ng-template tuiDataList>
                                        <tui-data-list>
                                            <button *ngFor="let language of languages" tuiOption
                                                [value]="language.code">
                                                {{ language.name | translate }}
                                            </button>
                                        </tui-data-list>
                                    </ng-template>
                                </tui-select>
                            </div>
                            <div *ngIf="libreTranslate.targetLanguages">
                                <tui-select tuiTextfieldSize="s" [(ngModel)]="libreTranslate.target"
                                    class="tui-group__inherit-item" [tuiTextfieldLabelOutside]="true"
                                    (ngModelChange)="libreTranslate.onTargetChange($event)">
                                    <input tuiTextfield placeholder="{{'libretranslate-target' | translate}}" />
                                    {{'libretranslate-target' | translate}}
                                    <tui-data-list-wrapper *tuiDataList [items]="libreTranslate.targetLanguages">
                                    </tui-data-list-wrapper>
                                    <ng-template #selectSource>
                                        {{'libretranslate-target' | translate}}
                                    </ng-template>
                                </tui-select>
                            </div>
                        </div>
                        <div class="tui-space_top-2" *ngIf="libreTranslate.target">
                            <h4>{{'libretranslate-translation-status' | translate}}</h4>
                            <button appearance="outline" tuiButton class="w-100" [icon]="'tuiIconActivity'" size="s"
                                (click)="libreTranslate.onTestTranslate()" [disabled]="
                                    ((libreTranslate.testing$ | async) ?? true) 
                                    || !libreTranslate.url 
                                    || !libreTranslate.source 
                                    || !libreTranslate.target">
                                {{'libretranslate-testtranslation' | translate}}
                            </button>
                        </div>
                    </ng-container>
                    <div *ngIf="libreTranslate.serverReady$ | async">
                        <tui-badge status="success" value="{{'libretranslate-ready' | translate}}"
                            class="tui-space_top-2 w-100"></tui-badge>
                    </div>
                    <div *ngIf="(libreTranslate.errorServer$ | async) as error" class="tui-space_top-2">
                        <tui-badge status="error" [value]="error" class="w-100"></tui-badge>
                    </div>
                </ng-container>
            </div>
        </tui-scrollbar>
    </button>
</header>