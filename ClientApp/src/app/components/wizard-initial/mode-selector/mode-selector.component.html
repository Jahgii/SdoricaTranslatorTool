<div class="mode-container">
    <div style="display: flex; justify-content: space-between; align-items: center;">
        <h2> {{'mode-selection' | translate}}</h2>
        <app-language-switcher />
    </div>
    <p>{{'select-mode-description' | translate}}</p>

    <form [formGroup]="modeForm" class="mode-form tui-space_bottom-6">
        <label appearance="secondary" tuiBlock="s">
            <tui-icon icon="computer" />
            <span tuiTitle>
                {{'offline' | translate}}
                <span tuiSubtitle>
                    {{'offline-mode-description' | translate}}
                </span>
            </span>
            <input formControlName="mode" tuiRadio type="radio" [value]="modes.Offline" />
        </label>
        <label appearance="secondary" tuiBlock="s">
            <tui-icon icon="server" />
            <span tuiTitle>
                {{'online' | translate}}
                <span tuiSubtitle>
                    {{'online-mode-description' | translate}}
                </span>
            </span>
            <input formControlName="mode" tuiRadio type="radio" [value]="modes.Online" />
        </label>
    </form>

    @if (modeControl?.value === modes.Online) {
    <form class="url-form tui-space_bottom-6" [formGroup]="modeForm">
        <div>
            <label tuiLabel>
                {{'api-url' | translate}}
                <tui-textfield class="tui-space_bottom-3" tuiTextfieldSize="s">
                    <input placeholder="https://..." tuiTextfield formControlName="apiUrl" />
                </tui-textfield>
            </label>
        </div>

        <div>
            <label tuiLabel>
                {{'api-key' | translate}}
                <tui-textfield class="tui-space_bottom-3" tuiTextfieldSize="s">
                    <input tuiTextfield formControlName="apiKey" />
                </tui-textfield>
            </label>
        </div>

        <tui-loader class="tui-space_bottom-3" [inheritColor]="true" [overlay]="true" [showLoader]="testApi()">
            <button type="button" tuiButton size="s" (click)="onTestServer()" [disabled]="modeForm.invalid">
                {{'test-server-api' | translate}}
            </button>
        </tui-loader>

    </form>
    }

    <button type="button" appearance="outline" tuiIconButton type="button" class="width100"
        iconStart="circle-arrow-right" shape="square" size="s" (click)="onNext()"
        [disabled]="modeForm.invalid || !apiAlive()" title="Next Step">
    </button>
</div>